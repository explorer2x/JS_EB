javascript: function test() { setTimeout(async () => { await navigator.clipboard.readText().then((clipboardString) => { const obj = JSON.parse(clipboardString); function get_sel(x) { var res = ""; for (var i = 0; i < x.options.length; i++) { if (x.options[i].value == x.value) { res = x.options[i].textContent; } }; return (res) } function get_full_state(stateName) { const stateNameToAbbreviation = { 'Alabama': 'AL', 'Alaska': 'AK', 'Arizona': 'AZ', 'Arkansas': 'AR', 'California': 'CA', 'Colorado': 'CO', 'Connecticut': 'CT', 'Delaware': 'DE', 'Florida': 'FL', 'Georgia': 'GA', 'Hawaii': 'HI', 'Idaho': 'ID', 'Illinois': 'IL', 'Indiana': 'IN', 'Iowa': 'IA', 'Kansas': 'KS', 'Kentucky': 'KY', 'Louisiana': 'LA', 'Maine': 'ME', 'Maryland': 'MD', 'Massachusetts': 'MA', 'Michigan': 'MI', 'Minnesota': 'MN', 'Mississippi': 'MS', 'Missouri': 'MO', 'Montana': 'MT', 'Nebraska': 'NE', 'Nevada': 'NV', 'New Hampshire': 'NH', 'New Jersey': 'NJ', 'New Mexico': 'NM', 'New York': 'NY', 'North Carolina': 'NC', 'North Dakota': 'ND', 'Ohio': 'OH', 'Oklahoma': 'OK', 'Oregon': 'OR', 'Pennsylvania': 'PA', 'Rhode Island': 'RI', 'South Carolina': 'SC', 'South Dakota': 'SD', 'Tennessee': 'TN', 'Texas': 'TX', 'Utah': 'UT', 'Vermont': 'VT', 'Virginia': 'VA', 'Washington': 'WA', 'West Virginia': 'WV', 'Wisconsin': 'WI', 'Wyoming': 'WY' }; const abbreviation = stateNameToAbbreviation[stateName]; if (abbreviation) { return abbreviation; } else { return stateName; } }; function get_short_state(statename) { const abbreviationToStateName = { 'AL': 'Alabama', 'AK': 'Alaska', 'AZ': 'Arizona', 'AR': 'Arkansas', 'CA': 'California', 'CO': 'Colorado', 'CT': 'Connecticut', 'DE': 'Delaware', 'FL': 'Florida', 'GA': 'Georgia', 'HI': 'Hawaii', 'ID': 'Idaho', 'IL': 'Illinois', 'IN': 'Indiana', 'IA': 'Iowa', 'KS': 'Kansas', 'KY': 'Kentucky', 'LA': 'Louisiana', 'ME': 'Maine', 'MD': 'Maryland', 'MA': 'Massachusetts', 'MI': 'Michigan', 'MN': 'Minnesota', 'MS': 'Mississippi', 'MO': 'Missouri', 'MT': 'Montana', 'NE': 'Nebraska', 'NV': 'Nevada', 'NH': 'New Hampshire', 'NJ': 'New Jersey', 'NM': 'New Mexico', 'NY': 'New York', 'NC': 'North Carolina', 'ND': 'North Dakota', 'OH': 'Ohio', 'OK': 'Oklahoma', 'OR': 'Oregon', 'PA': 'Pennsylvania', 'RI': 'Rhode Island', 'SC': 'South Carolina', 'SD': 'South Dakota', 'TN': 'Tennessee', 'TX': 'Texas', 'UT': 'Utah', 'VT': 'Vermont', 'VA': 'Virginia', 'WA': 'Washington', 'WV': 'West Virginia', 'WI': 'Wisconsin', 'WY': 'Wyoming' }; const abbreviation = abbreviationToStateName[stateName]; if (abbreviation) { return abbreviation; } else { return stateName; } } var dic = {}; if (document.domain.includes('ease.com')) { if (document.getElementById("detailsModal") != null) { if (document.getElementById("detailsModal").getAttribute("class") == "c-modal c-modal--responsive c-modal__background fadeInTop") { dic = { "DATE_OF_HIRE": "Hire Date", "FULL_PART_TIME": "Type", "TERM_REASON": "Termination Reason", "ANNUAL_SALARY": "Compensation", "HOUR_PER_WEEK": "Hours", "JOB_TITLE": "Job Title", "WORK_EMAIL": "Email", "PERSONAL_EMAIL": "Personal Email", "HOMEPHONE": "Personal Phone", "WORKPHONE": "Work Phone", "MARITAL_STATUS": "Marital Status", }; var cmb = document.getElementsByClassName('c-modal__body'); for (i = 0; i < cmb.length; i++) { if (cmb[i].children[0].getAttribute('class') == 'o-input-groups') { var cmb_el = cmb[i]; break; } } if (cmb_el) { var el_up = cmb_el.getElementsByClassName('o-input-groups')[0]; var allPageTags = el_up.getElementsByTagName("strong"); for (key in dic) { for (i = 0; i < allPageTags.length; i++) { var info = allPageTags[i].parentElement.textContent; t_title = info.split(":")[0]; t_value = info.split(":")[1]; if (dic[key] == t_title) { if (t_title == 'Compensation') { if (t_value.includes('Hourly')) { obj.ee_BASIC_info['PAY_PERIOD'] = 'H'; obj.ee_BASIC_info['HOURLY_SALARY'] = t_value.trim().split('/')[0].trim(); } else { obj.ee_BASIC_info['PAY_PERIOD'] = 'A'; obj.ee_BASIC_info['ANNUAL_SALARY'] = t_value.trim().split('/')[0].trim(); }; } else { obj.ee_BASIC_info[key] = t_value.trim() } } } }; var el_down = cmb_el.getElementsByClassName('c-list-view')[0].getElementsByClassName('c-list-view__body')[0]; var erow = el_down.getElementsByClassName("e-row"); for (i = 0; i < erow.length; i++) { var ediv = erow[i].getElementsByTagName("div"); relation = ediv[1].textContent.trim(); if (relation == 'Employee') { obj.ee_BASIC_info["FIRST_NAME"] = ediv[0].children[0].textContent.trim(); if (ediv[0].children.length > 2) { obj.ee_BASIC_info["MIDDLE_NAME"] = ediv[0].children[1].textContent.trim(); obj.ee_BASIC_info["LAST_NAME"] = ediv[0].children[2].textContent.trim(); } else { obj.ee_BASIC_info["LAST_NAME"] = ediv[0].children[1].textContent.trim(); }; obj.ee_BASIC_info["SSN"] = ediv[2].textContent.trim(); obj.ee_BASIC_info["GENDER"] = ediv[3].textContent.trim()[0]; obj.ee_BASIC_info["DOB"] = ediv[4].textContent.split(" ")[0].trim(); if (ediv[5].innerHTML.split('<br>').length > 3) { var len_add = ediv[5].innerHTML.split('<br>').length; obj.ee_BASIC_info.ADDZIP = ediv[5].innerHTML.split('<br>')[len_add - 1].trim(); obj.ee_BASIC_info.ADDSTATE = ediv[5].innerHTML.split('<br>')[len_add - 2].trim(); obj.ee_BASIC_info.ADDCITY = ediv[5].innerHTML.split('<br>')[len_add - 3].trim(); obj.ee_BASIC_info.ADD1 = ediv[5].innerHTML.split('<br>')[0].trim(); if (ediv[5].innerHTML.split('<br>').length > 4) { obj.ee_BASIC_info.ADD2 = ediv[5].innerHTML.split('<br>')[1].trim(); }; } }; const typeDict = { "Spouse": ["Spouse", "Spouse-Ex", "Domestic Partner"], "Child": ["Child", "Child-Domestic Partner", "Child-Adopted", "Child-Legal Guardian", "Child-Foster", "Child-Step", "Child-Grandchild"] }; function getType(name) { for (const [type, keywords] of Object.entries(typeDict)) { if (keywords.some(keyword => name.includes(keyword))) { type_dic = [type, name]; return type_dic; } } return ""; }; var relation_dic = getType(relation); if (relation_dic != '' && relation_dic[0] in obj.ee_DEPT_info) { if (obj.ee_DEPT_info[relation_dic[0]]["FIRST_NAME"] == "") { if (ediv[0].children.length > 2) { obj.ee_DEPT_info[relation_dic[0]]["MIDDLE_NAME"] = ediv[0].children[1].textContent.trim(); obj.ee_DEPT_info[relation_dic[0]]["LAST_NAME"] = ediv[0].children[2].textContent.trim(); } else { obj.ee_DEPT_info[relation_dic[0]]["LAST_NAME"] = ediv[0].children[1].textContent.trim(); }; obj.ee_DEPT_info[relation_dic[0]]["FIRST_NAME"] = ediv[0].children[0].textContent.trim(); obj.ee_DEPT_info[relation_dic[0]]["SSN"] = ediv[2].textContent.trim(); obj.ee_DEPT_info[relation_dic[0]]["GENDER"] = ediv[3].textContent.trim()[0]; obj.ee_DEPT_info[relation_dic[0]]["DOB"] = ediv[4].textContent.split(" ")[0].trim(); obj.ee_DEPT_info[relation_dic[0]]["RELATION"] = relation_dic[1]; } else { if (ediv[0].children.length > 2) { obj.ee_DEPT_info[relation_dic[0]]["MIDDLE_NAME"] = obj.ee_DEPT_info[relation_dic[0]]["MIDDLE_NAME"] + "|" + ediv[0].children[1].textContent.trim(); obj.ee_DEPT_info[relation_dic[0]]["LAST_NAME"] = obj.ee_DEPT_info[relation_dic[0]]["LAST_NAME"] + "|" + ediv[0].children[2].textContent.trim(); } else { obj.ee_DEPT_info[relation_dic[0]]["LAST_NAME"] = obj.ee_DEPT_info[relation_dic[0]]["LAST_NAME"] + "|" + ediv[0].children[1].textContent.trim(); }; obj.ee_DEPT_info[relation_dic[0]]["FIRST_NAME"] = obj.ee_DEPT_info[relation_dic[0]]["FIRST_NAME"] + "|" + ediv[0].children[0].textContent.trim(); obj.ee_DEPT_info[relation_dic[0]]["SSN"] = obj.ee_DEPT_info[relation_dic[0]]["SSN"] + "|" + ediv[2].textContent.trim(); obj.ee_DEPT_info[relation_dic[0]]["GENDER"] = obj.ee_DEPT_info[relation_dic[0]]["GENDER"] + "|" + ediv[3].textContent.trim()[0]; obj.ee_DEPT_info[relation_dic[0]]["DOB"] = obj.ee_DEPT_info[relation_dic[0]]["DOB"] + "|" + ediv[4].textContent.split(" ")[0].trim(); obj.ee_DEPT_info[relation_dic[0]]["RELATION"] = obj.ee_DEPT_info[relation_dic[0]]["RELATION"] + "|" + relation_dic[1]; }; } } } }; } else { if (document.getElementById("dependentModalTrigger") == null) { dic = { "FIRST_NAME": "firstname", "MIDDLE_NAME": "middlename", "LAST_NAME": "lastname", "DOB": "birthdate", "SSN": "ssn", "ADD1": "addr1", "ADD2": "addr2", "ADDZIP": "zip", "HOMEPHONE": "homephone", "WORKPHONE": "workphone", "ADDCITY": "city", "ADDCOUNTY": "county", "ANNUAL_SALARY": "compensationAmount", "HOUR_PER_WEEK": "hours", "DATE_OF_HIRE": "hiredate", "PERSONAL_EMAIL": "personalemail", }; for (key in dic) { if (document.getElementById(dic[key]) != null) { if (document.getElementById(dic[key]).value != "") { if (key in obj.ee_BASIC_info) { obj.ee_BASIC_info[key] = document.getElementById(dic[key]).value } } } }; if (obj.ee_BASIC_info.ANNUAL_SALARY != '' && obj.ee_BASIC_info.HOUR_PER_WEEK == '') { obj.ee_BASIC_info['PAY_PERIOD'] = 'A'; } else if (obj.ee_BASIC_info.ANNUAL_SALARY == '' && obj.ee_BASIC_info.HOUR_PER_WEEK != '') { obj.ee_BASIC_info['PAY_PERIOD'] = 'H'; }; if (document.getElementById('c-input__label-sex') != null) { if (document.getElementById('c-input__label-sex').parentElement.nextElementSibling != null) { obj.ee_BASIC_info.GENDER = document.getElementById('c-input__label-sex').parentElement.nextElementSibling.textContent } }; var state_el = document.querySelector("#stateRow > div > div.c-input > div.c-select__handle > div.c-input__value"); if (state_el) { obj.ee_BASIC_info.ADDSTATE = state_el.textContent }; var married_el = document.querySelector("#maritalRow > div > div.c-input > div.c-select__handle > div.c-input__value"); if (married_el) { obj.ee_BASIC_info.MARITAL_STATUS = married_el.textContent }; } else if (document.getElementById('dependentModalTrigger') != null) { var dept_obj = JSON.parse(document.getElementById('dependentModalTrigger').value); for (i = 0; i < dept_obj.data.length; i++) { if (dept_obj.data[i].key == "relationship") { relation_v = (dept_obj.data[i].value); break; } }; const typeDict = { "Spouse": ["Spouse", "Spouse-Ex", "Domestic Partner"], "Child": ["Child", "Child-Domestic Partner", "Child-Adopted", "Child-Legal Guardian", "Child-Foster", "Child-Step", "Child-Grandchild"] }; function getType(name) { for (const [type, keywords] of Object.entries(typeDict)) { if (keywords.some(keyword => name.includes(keyword))) { type_dic = [type, name]; return type_dic; } } return ""; }; var relation_dic = getType(relation_v); if (relation_dic != '' && relation_dic[0] in obj.ee_DEPT_info) { dic = { "FIRST_NAME": "firstname", "MIDDLE_NAME": "middlename", "LAST_NAME": "lastname", "GENDER": "sex", "DOB": "birthdate", "SSN": "ssn", "ADD1": "addr1", "ADD2": "addr2", "ADDZIP": "zip", "HOMEPHONE": "homephone", "WORKPHONE": "workphone", "ADDCITY": "city", "ADDCOUNTY": "county", }; if (obj.ee_DEPT_info[relation_dic[0]]["FIRST_NAME"] == "") { for (i = 0; i < dept_obj.data.length; i++) { for (key in dic) { if (dept_obj.data[i].key == dic[key]) { obj.ee_DEPT_info[relation_dic[0]][key] = dept_obj.data[i].value } } }; obj.ee_DEPT_info[relation_dic[0]]['RELATION'] = relation_dic[1]; } else { for (i = 0; i < dept_obj.data.length; i++) { for (key in dic) { if (dept_obj.data[i].key == dic[key]) { obj.ee_DEPT_info[relation_dic[0]][key] = obj.ee_DEPT_info[relation_dic[0]][key] + "|" + dept_obj.data[i].value } } }; } } else { alert('this relationship is not valid in JS, need manual entry') }; }; } }; if (document.domain.includes("employeenavigator.com")) { if (document.querySelector("#companyWall > div > div.wall_header") != null) { const wall_dic = {}; const tables = document.querySelector("#event_print > div:nth-child(3) > div:nth-child(1)").querySelectorAll('.table'); for (t = 0; t < tables.length; t++) { const k = tables[t].previousElementSibling.textContent.trim(); const tableRows = tables[t].querySelectorAll(' tbody tr'); const info = {}; tableRows.forEach((row) => { const key = row.querySelector("td.bold").textContent.trim(); const value = row.querySelector("td:not(.bold)").textContent.trim(); info[key] = value; }); wall_dic[k] = info; } if (Object.keys(wall_dic).length > 0) { dic = { "First Name:": "FIRST_NAME", "Last Name:": "LAST_NAME", "Middle:": "MIDDLE_NAME", "SSN:": "SSN", "DOB:": "DOB", "Sex:": "GENDER", "Marital Status:": "MARITAL_STATUS", "Home Phone:": "HOMEPHONE", "Work Phone:": "WORKPHONE", "Email:": "WORK_EMAIL", "Home Address 1:": "ADD1", "Home Address 2:": "ADD2", "City:": "ADDCITY", "State:": "ADDSTATE", "Zip:": "ADDZIP", "County:": "ADDCOUNTY", "Date of Hire:": "DATE_OF_HIRE", "Base Salary:": "ANNUAL_SALARY", "Hours Worked Per Week:": "HOUR_PER_WEEK", "Job Title:": "JOB_TITLE", }; const tier = ['Employee Information', 'Employment Information']; for (kitem of tier) { for (var wkdk in wall_dic[kitem]) { if (wkdk in dic && wall_dic[kitem][wkdk] != '') { if (dic[wkdk] in obj.ee_BASIC_info) { if (dic[wkdk] == "HOMEPHONE" || dic[wkdk] == "WORKPHONE") { obj.ee_BASIC_info[dic[wkdk]] = wall_dic[kitem][wkdk].replace(/[^\d]+/g, ''); } else { obj.ee_BASIC_info[dic[wkdk]] = wall_dic[kitem][wkdk]; } } } } } const SPkitem_list = ['Employment Information', 'Event Details', 'Employee Information']; const dpt_dic = { "DOB:": "DOB", "Disabled:": "IF_DISABLED", "First Name:": "FIRST_NAME", "Last Name:": "LAST_NAME", "Middle Name:": "MIDDLE_NAME", "Relationship:": "RELATION", "SSN:": "SSN", "Sex:": "GENDER", }; for (var kitem in wall_dic) { if (!SPkitem_list.includes(kitem)) { if ('Relationship:' in wall_dic[kitem] && wall_dic[kitem]['Relationship:'] in obj.ee_DEPT_info) { var rel = wall_dic[kitem]['Relationship:']; for (var wkdk in wall_dic[kitem]) { if (wkdk in dpt_dic && wall_dic[kitem][wkdk] != '') { if (obj.ee_DEPT_info[rel][dpt_dic[wkdk]] == '') { obj.ee_DEPT_info[rel][dpt_dic[wkdk]] = wall_dic[kitem][wkdk]; } else { obj.ee_DEPT_info[rel][dpt_dic[wkdk]] = wall_dic[kitem][wkdk] + '|' + obj.ee_DEPT_info[rel][dpt_dic[wkdk]]; } } } } } } } } else { if (document.getElementById("LkpRelationshipId") == null) { dic = { "SSN": "SSN", "FIRST_NAME": "FirstName", "MIDDLE_NAME": "MiddleName", "LAST_NAME": "LastName", "JOB_TITLE": "JobTitle", "DATE_OF_HIRE": "HireDate", "DOB": "DOB", }; for (key in dic) { if (document.getElementById(dic[key]) != null) { if (document.getElementById(dic[key]).value != "") { if (key in obj.ee_BASIC_info) { obj.ee_BASIC_info[key] = document.getElementById(dic[key]).value; } } } }; if (document.body.textContent.includes('Phones')) { var parentDiv = document.querySelector("#contact_phone_list > div > h4").parentElement.children[1].getElementsByTagName("table"); if (parentDiv.length > 0) { var trow = parentDiv[0].getElementsByTagName("tbody")[0].getElementsByTagName("tr")[0]; var typeCell = trow.getElementsByTagName("td")[0]; var numberCell = trow.getElementsByTagName("td")[1]; if (typeCell.innerText == 'Home') { obj.ee_BASIC_info.HOMEPHONE = numberCell.innerText.replace(/[^\d]+/g, ''); } else { obj.ee_BASIC_info.WORKPHONE = numberCell.innerText.replace(/[^\d]+/g, ''); } } const primary_email = document.getElementById('LkpPrimaryEmailTypeId').options[document.getElementById('LkpPrimaryEmailTypeId').selectedIndex].text; if (primary_email == 'Work') { obj.ee_BASIC_info['WORK_EMAIL'] = document.getElementById('WorkEmail').value; } else if (primary_email == 'Personal') { obj.ee_BASIC_info['PERSONAL_EMAIL'] = document.getElementById('PersonalEmail').value; } else { obj.ee_BASIC_info['WORK_EMAIL'] = document.getElementById('WorkEmail').value; obj.ee_BASIC_info['PERSONAL_EMAIL'] = document.getElementById('PersonalEmail').value; }; } dic_sel = { "PAY_PERIOD": "LkpPayrollGroup", "DIVISION": "LkpDivision", "DEPARTMENT": "LkpDept", "FULL_PART_TIME": "LkpClientClass", }; for (key in dic_sel) { if (document.getElementById(dic[key]) != null) { if (get_sel(document.getElementById(dic_sel[key])) != "") { if (key in obj.ee_BASIC_info) { obj.ee_BASIC_info[key] = document.getElementById(dic_sel[key]).selectedOptions[0].textContent } } } }; if (document.getElementById("DOB") != null) { var allPageTags = document.getElementsByTagName("input"); for (i = 0; i < allPageTags.length; i++) { if (allPageTags[i].name == 'Gender') { if (allPageTags[i].checked == true) { obj.ee_BASIC_info.GENDER = (allPageTags[i].value) } } } }; if (window.__PROFILE_ADDRESS_LIST__ != null) { obj.ee_BASIC_info.ADD1 = window.__PROFILE_ADDRESS_LIST__[0].Address1; if (window.__PROFILE_ADDRESS_LIST__[0].Address2 != null) { obj.ee_BASIC_info.ADD2 = window.__PROFILE_ADDRESS_LIST__[0].Address2; } obj.ee_BASIC_info.ADDCITY = window.__PROFILE_ADDRESS_LIST__[0].City; obj.ee_BASIC_info.ADDSTATE = window.__PROFILE_ADDRESS_LIST__[0].StateDisplay; if (window.__PROFILE_ADDRESS_LIST__[0].Zip.length >= 5) { obj.ee_BASIC_info.ADDZIP = window.__PROFILE_ADDRESS_LIST__[0].Zip.slice(0, 5); }; }; if (document.getElementById('LkpMaritalStatusId') != null) { if (document.getElementById('LkpMaritalStatusId').selectedOptions[0].textContent != '--Select--') { obj.ee_BASIC_info.MARITAL_STATUS = document.getElementById('LkpMaritalStatusId').selectedOptions[0].textContent }; } if (document.documentElement.innerText.includes("Annual base salary")) { list_e = [document.querySelectorAll('div[class="form-control-static"]')[0], document.querySelectorAll('div[class="form-control-static"]')[1], document.querySelector("#hris_form > div > div.col-md-9 > div:nth-child(10) > div.col-md-8")]; list_j = ['ANNUAL_SALARY', 'HOURLY_SALARY', 'HOUR_PER_WEEK']; for (let i = 0; i < list_e.length; i++) { var myVariable = list_e[i] && list_e[i].textContent.trim(); if (myVariable) { if (i != 2) { obj.ee_BASIC_info[list_j[i]] = myVariable.match(/\$\d{1,3}(?:,?\d{3})*(?:\.\d{2})?/)[0]; } else { obj.ee_BASIC_info[list_j[i]] = myVariable.trim(); } } } } }; if (document.getElementById("LkpRelationshipId") != null) { dic_dep = { "FIRST_NAME": "FirstName", "MIDDLE_NAME": "MiddleName", "LAST_NAME": "LastName", "DOB": "DOB", "SSN": "SSN", "RELATION": "LkpRelationshipId" }; relation = get_sel(document.getElementById('LkpRelationshipId')); if (relation in obj.ee_DEPT_info) { if (obj.ee_DEPT_info[relation]["SSN"] == "") { for (key in dic_dep) { if (document.getElementById(dic_dep[key]) != null) { if (document.getElementById(dic_dep[key]).value != "") { if (key in obj.ee_DEPT_info[relation]) { if (key == 'RELATION') { const selectElement = document.getElementById(dic_dep[key]); const selectedIndex = selectElement.selectedIndex; const selectedOption = selectElement.options[selectedIndex]; obj.ee_DEPT_info[relation][key] = selectedOption.textContent; } else { obj.ee_DEPT_info[relation][key] = document.getElementById(dic_dep[key]).value } } } } }; var allPageTags = document.getElementById('edit_data_modal').getElementsByTagName("input"); for (i = 0; i < allPageTags.length; i++) { if (allPageTags[i].name == 'Gender') { if (allPageTags[i].checked == true) { obj.ee_DEPT_info[relation].GENDER = (allPageTags[i].value) } } }; } else { for (key in dic_dep) { if (document.getElementById(dic_dep[key]) != null) { if (document.getElementById(dic_dep[key]).value != "") { if (key in obj.ee_DEPT_info[relation]) { if (key == 'RELATION') { const selectElement = document.getElementById(dic_dep[key]); const selectedIndex = selectElement.selectedIndex; const selectedOption = selectElement.options[selectedIndex]; obj.ee_DEPT_info[relation][key] = obj.ee_DEPT_info[relation][key] + "|" + selectedOption.textContent; } else { obj.ee_DEPT_info[relation][key] = obj.ee_DEPT_info[relation][key] + "|" + document.getElementById(dic_dep[key]).value } } } } }; var allPageTags = document.getElementById('edit_data_modal').getElementsByTagName("input"); for (i = 0; i < allPageTags.length; i++) { if (allPageTags[i].name == 'Gender') { if (allPageTags[i].checked == true) { obj.ee_DEPT_info[relation].GENDER = obj.ee_DEPT_info[relation].GENDER + "|" + allPageTags[i].value } } }; }; } }; } } if (document.domain.includes('goco.io') == true) { if (document.body.innerText.includes('Personal Information')) { async function handle_page() { var allPageTags = document.getElementsByTagName("span"); for (i = 0; i < allPageTags.length; i++) if (allPageTags[i].textContent == 'Employment Info') { allPageTags[i].click(); break; } await delay(1); var allPageTags = document.getElementsByTagName("div"); for (i = 0; i < allPageTags.length; i++) if (allPageTags[i].textContent.trim() == 'Personal Information') { var PI_el = allPageTags[i].parentElement.nextElementSibling; var alldiv = PI_el.getElementsByTagName("div"); for (o = 0; o < alldiv.length; o++) { if (alldiv[o].textContent.trim() == 'View') { alldiv[o].click(); } } } await delay(1); }; function delay(n) { return new Promise(function(resolve) { setTimeout(resolve, n * 20); }); }; function get_ele_by_txt(el_txt) { var allPageTags = document.getElementsByTagName("div"); for (i = 0; i < allPageTags.length; i++) if (allPageTags[i].textContent.trim() == el_txt) { tgt_ele = (allPageTags[i].parentElement.nextElementSibling); break; } return (tgt_ele) }; async function get_data(el_name, parent_el) { var allPageTags = parent_el.getElementsByTagName("div"); for (i = 0; i < allPageTags.length; i++) if (allPageTags[i].textContent.trim() == el_name && allPageTags[i].nextElementSibling != null) { if (allPageTags[i].nextElementSibling.children.length > 0) { if (allPageTags[i].nextElementSibling.getAttribute('class').includes('hide')) { allPageTags[i].nextElementSibling.children[0].click(); await delay(1); } await delay(1); var res = (allPageTags[i].nextElementSibling.textContent.trim()); break; } } return (res); }; function get_emp(el_name, parent_el) { var allPageTags = parent_el.getElementsByTagName("label"); for (i = 0; i < allPageTags.length; i++) if (allPageTags[i].textContent.trim() == el_name) { var res = (allPageTags[i].nextElementSibling.textContent.trim()); break; } return (res); }; function get_ele_by_txt_emp() { var allPageTags = document.getElementsByTagName("div"); for (i = 0; i < allPageTags.length; i++) if (allPageTags[i].getAttribute('class') == 'employment-tabs tabs') { var tgt_ele = allPageTags[i]; break; } return (tgt_ele); }; async function geteePI() { dic = { "SSN": "SSN", "FULL_NAME": "Legal Name", "DOB": "Date of Birth", "GENDER": "Legal Sex" }; var ee_parent = get_ele_by_txt('Personal Information'); for (var key in dic) { if (dic[key] != '') { var key_res = await get_data(dic[key], ee_parent); if (key_res) { if (key_res.includes('Hide')) { key_res = key_res.replace('Hide', '') }; obj.ee_BASIC_info[key] = key_res; } } } }; async function geteeCI() { dic = { "HOMEPHONE": "Personal Phone", "WORK_EMAIL": "Work Email", "WORKPHONE": "Work Phone", "PERSONAL_EMAIL": "Personal Email" }; var ee_contact_parent = get_ele_by_txt("Contact Information"); for (var key in dic) { if (dic[key] != '') { var key_res = await get_data(dic[key], ee_contact_parent); if (key_res) { obj.ee_BASIC_info[key] = key_res; } } }; get_address(); }; function get_address() { var ee_contact_parent = get_ele_by_txt("Contact Information"); var allPageTags = ee_contact_parent.getElementsByTagName("div"); for (i = 0; i < allPageTags.length; i++) if (allPageTags[i].textContent.trim() == 'Home Address' && allPageTags[i].nextElementSibling != null) { if (allPageTags[i].nextElementSibling.children.length > 0) { var HA_el = allPageTags[i].nextElementSibling.children[0]; var HA_eltag = HA_el.getElementsByTagName("div"); if (HA_eltag.length == 5) { obj.ee_BASIC_info['ADD1'] = HA_eltag[0].textContent.trim(); obj.ee_BASIC_info['ADDCITY'] = HA_eltag[1].textContent.trim().split(',')[0].trim(); obj.ee_BASIC_info['ADDSTATE'] = HA_eltag[1].textContent.trim().split(',')[1].trim(); obj.ee_BASIC_info['ADDZIP'] = HA_eltag[2].textContent.trim().match(/\d+/g).join(''); } else if (HA_eltag.length == 6) { obj.ee_BASIC_info['ADD1'] = HA_eltag[0].textContent.trim(); obj.ee_BASIC_info['ADD2'] = HA_eltag[1].textContent.trim(); obj.ee_BASIC_info['ADDCITY'] = HA_eltag[2].textContent.trim().split(',')[0].trim(); obj.ee_BASIC_info['ADDSTATE'] = HA_eltag[2].textContent.trim().split(',')[1].trim(); obj.ee_BASIC_info['ADDZIP'] = HA_eltag[3].textContent.trim().match(/\d+/g).join(''); } } break; } } function handle_wage() {} async function getemployment() { await delay(10); dic = { "DATE_OF_HIRE": "Start Date", "JOB_TITLE": "Title", "MARITAL_STATUS": "Married", "HOUR_PER_WEEK": "Hours per Week", "ANNUAL_SALARY": "Wage", "FULL_PART_TIME": "Employment Type", "OFFICE": "Headquarters", "DIVISION": "Division", "DEPARTMENT": "Department" }; var ee_emp_parent = get_ele_by_txt_emp(); for (var key in dic) { if (dic[key] != '') { var key_res = await get_emp(dic[key], ee_emp_parent); if (key_res) { if (dic[key] == 'Wage') { if (key_res.includes('Hourly Rate')) { obj.ee_BASIC_info['HOURLY_SALARY'] = key_res.split(' ')[0]; } else if (key_res.includes('Annual Salary')) { obj.ee_BASIC_info['ANNUAL_SALARY'] = key_res.split(' ')[0]; } } else { obj.ee_BASIC_info[key] = key_res; } } } }; } async function job() { await handle_page(); await geteePI(); await geteeCI(); await getemployment(); console.log(obj) }; job() }; }; let newClipboardString = JSON.stringify(obj); navigator.clipboard.writeText(newClipboardString); }); }, 100); }; test();
