if (document.domain == "visionbenefits.vsp.com") { if (document.getElementById("emailWork") != null) { const dic = { "FIRST_NAME": "firstname", "LAST_NAME": "lastname", "PERSONAL_EMAIL": "emailHome", "WORK_EMAIL": "emailWork", "ADD1": "street", "ADDCITY": "city", "ADD2": "street2", "ADDZIP": "zip", "HOMEPHONE": "phone", "ADDSTATE": "state", }; for (var keyv in dic) { var itemv = dic[keyv]; if (itemv != '') { var tgt_elv = document.getElementById(itemv); tgt_elv.dispatchEvent(new Event('focusin')); tgt_elv.value = jsonObject.ee_BASIC_info[keyv]; tgt_elv.dispatchEvent(new Event('change')); tgt_elv.dispatchEvent(new Event('blur')); tgt_elv.dispatchEvent(new Event('focusout')); }; }; var dob = jsonObject.ee_BASIC_info['DOB']; if (dob != '') { var dob_dateObj = new Date(dob); document.getElementById('birthDate_month').value = dob_dateObj.getMonth(); document.getElementById('birthDate_day').value = dob_dateObj.getDate(); document.getElementById('birthDate_year').value = dob_dateObj.getFullYear(); }; var doe = jsonObject.ee_BASIC_info['ELIG_DATE']; if (doe != '') { var doe_dateObj = new Date(doe); document.getElementById('effDate_month').value = doe_dateObj.getMonth(); document.getElementById('effDate_day').value = doe_dateObj.getDate(); document.getElementById('effDate_year').value = doe_dateObj.getFullYear(); }; var sex_v = jsonObject.ee_BASIC_info['GENDER']; if (sex_v == 'F' || sex_v == 'Female') { sex_v = 'FEMALE' } else if (sex_v == 'M' || sex_v == 'Male') { sex_v = 'MALE' }; document.getElementById('sex').value = sex_v; var state_v = get_short_state(jsonObject.ee_BASIC_info['ADDSTATE']); if (state_v) { input_refresh('state', state_v) }; }; if (document.getElementById("manage-dependents_manageDependents_0__action") != null) { const dept_dic = { "FIRST_NAME": "manage-dependents_manageDependents_0__dependent_name_firstname", "LAST_NAME": "manage-dependents_manageDependents_0__dependent_name_lastname", "DOB": "manage-dependents_manageDependents_0__dependent_birthDate", "SSN": "manage-dependents_manageDependents_0__dependent_id", }; var vsp_dep_i = 0; function delay(n) { return new Promise(function(resolve) { setTimeout(resolve, n * 50); }); } async function vsp_dept_enter() { if (jsonObject.ee_DEPT_info.Spouse.FIRST_NAME != "") { const sp_act_k = 'manage-dependents_manageDependents_0__action'; input_refresh(sp_act_k.replace('0', vsp_dep_i), 'ADD'); await delay(1); for (var key in dept_dic) { var itemv = dept_dic[key]; if (itemv != '') { if (key == "SSN") { var tgt_elv = document.getElementById(itemv.replace('0', vsp_dep_i)); input_refresh_el(tgt_elv, jsonObject.ee_DEPT_info.Spouse[key].replace(/[^\d]+/g, '')); } else { var tgt_elv = document.getElementById(itemv.replace('0', vsp_dep_i)); input_refresh_el(tgt_elv, jsonObject.ee_DEPT_info.Spouse[key]); }; }; }; var sex_v = jsonObject.ee_DEPT_info.Spouse['GENDER']; if (sex_v == 'F' || sex_v == 'Female') { sex_v = 'FEMALE' } else if (sex_v == 'M' || sex_v == 'Male') { sex_v = 'MALE' }; const spouse_gender = 'manage-dependents_manageDependents_0__dependent_gender'; input_refresh(spouse_gender.replace('0', vsp_dep_i), sex_v); const spouse_rel = 'manage-dependents_manageDependents_0__dependent_relationship'; input_refresh(spouse_rel.replace('0', vsp_dep_i), 'SPOUSE'); const spouse_eff = 'manage-dependents_manageDependents_0__effectiveDate_value'; input_refresh(spouse_eff.replace('0', vsp_dep_i), jsonObject.ee_BASIC_info['ELIG_DATE']); jsonObject.ee_DEPT_info.Spouse.is_entered = "T"; vsp_dep_i++; }; if (jsonObject.ee_DEPT_info.Child.FIRST_NAME != "") { if (jsonObject.ee_DEPT_info.Child.FIRST_NAME.includes('|') == false) { if (jsonObject.ee_DEPT_info.Child.is_entered != "T") { const ch_act_k = 'manage-dependents_manageDependents_0__action'; input_refresh(ch_act_k.replace('0', vsp_dep_i), 'ADD'); await delay(1); for (var keyv in dept_dic) { var itemv = dept_dic[keyv]; if (itemv != '' && jsonObject.ee_DEPT_info.Child[keyv] != "") { if (keyv == "SSN") { var tgt_elv = document.getElementById(itemv.replace('0', vsp_dep_i)); input_refresh_el(tgt_elv, jsonObject.ee_DEPT_info.Child[keyv].replace(/[^\d]+/g, '')); } else { var tgt_elv = document.getElementById(itemv.replace('0', vsp_dep_i)); input_refresh_el(tgt_elv, jsonObject.ee_DEPT_info.Child[keyv]); }; }; }; var sex_v = jsonObject.ee_DEPT_info.Child['GENDER']; if (sex_v == 'F' || sex_v == 'Female') { sex_v = 'FEMALE' } else if (sex_v == 'M' || sex_v == 'Male') { sex_v = 'MALE' }; const ch_gender = 'manage-dependents_manageDependents_0__dependent_gender'; input_refresh(ch_gender.replace('0', vsp_dep_i), sex_v); const ch_rel = 'manage-dependents_manageDependents_0__dependent_relationship'; input_refresh(ch_rel.replace('0', vsp_dep_i), 'CHILD'); const ch_eff = 'manage-dependents_manageDependents_0__effectiveDate_value'; input_refresh(ch_eff.replace('0', vsp_dep_i), jsonObject.ee_BASIC_info['ELIG_DATE']); jsonObject.ee_DEPT_info.Child.is_entered = "T"; vsp_dep_i++; } } else { child_ct = jsonObject.ee_DEPT_info.Child.FIRST_NAME.split("|").length; for (var child_entered_ct = 0; child_entered_ct < child_ct; child_entered_ct++) { const chm_act_k = 'manage-dependents_manageDependents_0__action'; input_refresh(chm_act_k.replace('0', vsp_dep_i), 'ADD'); await delay(1); for (var keyv in dept_dic) { var itemv = dept_dic[keyv]; if (itemv != '' && jsonObject.ee_DEPT_info.Child[keyv] != '') { if (keyv == "SSN") { var tgt_elv = document.getElementById(itemv.replace('0', vsp_dep_i)); input_refresh_el(tgt_elv, jsonObject.ee_DEPT_info.Child[keyv].split("|")[child_entered_ct].replace(/[^\d]+/g, '')); } else { var tgt_elv = document.getElementById(itemv.replace('0', vsp_dep_i)); input_refresh_el(tgt_elv, jsonObject.ee_DEPT_info.Child[keyv].split("|")[child_entered_ct]); }; }; }; var sex_v = jsonObject.ee_DEPT_info.Child['GENDER'].split("|")[child_entered_ct]; if (sex_v == 'F' || sex_v == 'Female') { sex_v = 'FEMALE' } else if (sex_v == 'M' || sex_v == 'Male') { sex_v = 'MALE' }; const chm_gender = 'manage-dependents_manageDependents_0__dependent_gender'; input_refresh(chm_gender.replace('0', vsp_dep_i), sex_v); const chm_rel = 'manage-dependents_manageDependents_0__dependent_relationship'; input_refresh(chm_rel.replace('0', vsp_dep_i), 'CHILD'); const chm_eff = 'manage-dependents_manageDependents_0__effectiveDate_value'; input_refresh(chm_eff.replace('0', vsp_dep_i), jsonObject.ee_BASIC_info['ELIG_DATE']); if (child_entered_ct == 0) { jsonObject.ee_DEPT_info.Child.is_entered = "T"; } else { jsonObject.ee_DEPT_info.Child.is_entered = jsonObject.ee_DEPT_info.Child.is_entered + "|" + "T"; }; vsp_dep_i++ } }; }; }; vsp_dept_enter(); } };