if (document.domain == 'cobra.flexadministrators.com') { function delay(n) { return new Promise(function(resolve) { setTimeout(resolve, n * 200); }); }; if (document.getElementById('ctl00_MainPaneContentPlaceHolder_NPMEdit1_NPMGeneral1_FormView1_txtFirstName') != null) { const dic = { 'FIRST_NAME': 'ctl00_MainPaneContentPlaceHolder_NPMEdit1_NPMGeneral1_FormView1_txtFirstName', 'LAST_NAME': 'ctl00_MainPaneContentPlaceHolder_NPMEdit1_NPMGeneral1_FormView1_txtLastName', 'SSN': 'ctl00_MainPaneContentPlaceHolder_NPMEdit1_NPMGeneral1_FormView1_rmtSSN', 'ADD1': 'ctl00_MainPaneContentPlaceHolder_NPMEdit1_NPMGeneral1_FormView1_txtAddress', 'ADD2': 'ctl00_MainPaneContentPlaceHolder_NPMEdit1_NPMGeneral1_FormView1_txtAddress2', 'ADDCITY': 'ctl00_MainPaneContentPlaceHolder_NPMEdit1_NPMGeneral1_FormView1_txtCity', 'ADDZIP': 'ctl00_MainPaneContentPlaceHolder_NPMEdit1_NPMGeneral1_FormView1_txtZipcode', 'ADDSTATE': 'ctl00_MainPaneContentPlaceHolder_NPMEdit1_NPMGeneral1_FormView1_txtState', 'GENDER': 'ctl00_MainPaneContentPlaceHolder_NPMEdit1_NPMGeneral1_FormView1_rcbSex_Arrow', 'MIDDLE_NAME': 'ctl00_MainPaneContentPlaceHolder_NPMEdit1_NPMGeneral1_FormView1_txtMiddleInitial', 'DATE_OF_HIRE': 'ctl00_MainPaneContentPlaceHolder_NPMEdit1_NPMGeneral1_FormView1_rdiHireDate', 'Email': 'ctl00_MainPaneContentPlaceHolder_NPMEdit1_NPMGeneral1_FormView1_txtEmail' }; for (var keyv in dic) { var itemv = dic[keyv]; var el = document.getElementById(itemv); switch (keyv) { case 'ADDSTATE': console.log(jsonObject.ee_BASIC_info[keyv]); console.log(get_short_state(jsonObject.ee_BASIC_info[keyv])); el.value = get_short_state(jsonObject.ee_BASIC_info[keyv]); break; case 'GENDER': el.dispatchEvent(new Event('click')); await delay(2); var parentDiv = document.querySelector("#ctl00_MainPaneContentPlaceHolder_NPMEdit1_NPMGeneral1_FormView1_rcbSex_DropDown > div"); var childDivs = parentDiv.querySelectorAll('li'); if (jsonObject.ee_BASIC_info[keyv] == "M" || jsonObject.ee_BASIC_info[keyv] == "Male") { var gender = 'Male'; } else if (jsonObject.ee_BASIC_info[keyv] == "F" || jsonObject.ee_BASIC_info[keyv] == "Female") { var gender = 'Female'; }; console.log(gender); for (var i = 0; i < childDivs.length; i++) { if (childDivs[i].innerText == gender) { await delay(2); childDivs[i].click(); break; }; }; break; case 'MIDDLE_NAME': if (jsonObject.ee_BASIC_info.MIDDLE_NAME != '') { el.value = jsonObject.ee_BASIC_info.MIDDLE_NAME.charAt(0); }; break; case 'DATE_OF_HIRE': if (jsonObject.ee_BASIC_info.DATE_OF_HIRE != '') { if (jsonObject.ee_BASIC_info.DATE_OF_HIRE.includes(" ") == true) { var HireDate = jsonObject.ee_BASIC_info.DATE_OF_HIRE.split(" ")[0]; } else { var HireDate = jsonObject.ee_BASIC_info.DATE_OF_HIRE; }; }; el.value = HireDate; break; case 'Email': if (jsonObject.ee_BASIC_info.PERSONAL_EMAIL != '') { el.value = jsonObject.ee_BASIC_info.PERSONAL_EMAIL; } else if (jsonObject.ee_BASIC_info.WORK_EMAIL != '') { el.value = jsonObject.ee_BASIC_info.WORK_EMAIL; }; break; default: console.log(jsonObject.ee_BASIC_info[keyv]); el.value = jsonObject.ee_BASIC_info[keyv]; }; }; if (jsonObject.ee_BASIC_info.HOMEPHONE != '' && jsonObject.ee_BASIC_info.WORKPHONE != '') { var HomePhone = jsonObject.ee_BASIC_info.HOMEPHONE; if (/[^0-9]/.test(HomePhone)) { HomePhone = HomePhone.replace(/\D/g, ""); }; var PhonePart1 = HomePhone.slice(0, 3); var PhonePart2 = HomePhone.slice(3, 6); var PhonePart3 = HomePhone.slice(6); var formattedHomePhone = `(${PhonePart1}) ${PhonePart2}-${PhonePart3}`; console.log(formattedHomePhone); var WorkPhone = jsonObject.ee_BASIC_info.WORKPHONE; if (/[^0-9]/.test(WorkPhone)) { WorkPhone = WorkPhone.replace(/\D/g, ""); }; var PhonePart1 = WorkPhone.slice(0, 3); var PhonePart2 = WorkPhone.slice(3, 6); var PhonePart3 = WorkPhone.slice(6); var formattedWorkPhone = `(${PhonePart1}) ${PhonePart2}-${PhonePart3}`; console.log(formattedWorkPhone); document.getElementById('ctl00_MainPaneContentPlaceHolder_NPMEdit1_NPMGeneral1_FormView1_rmtPhone').value = formattedHomePhone; document.getElementById('ctl00_MainPaneContentPlaceHolder_NPMEdit1_NPMGeneral1_FormView1_rmtPhone2').value = formattedWorkPhone; } else if (jsonObject.ee_BASIC_info.HOMEPHONE != '' && jsonObject.ee_BASIC_info.WORKPHONE == '') { var HomePhone = jsonObject.ee_BASIC_info.HOMEPHONE; if (/[^0-9]/.test(HomePhone)) { HomePhone = HomePhone.replace(/\D/g, ""); }; var PhonePart1 = HomePhone.slice(0, 3); var PhonePart2 = HomePhone.slice(3, 6); var PhonePart3 = HomePhone.slice(6); var formattedHomePhone = `(${PhonePart1}) ${PhonePart2}-${PhonePart3}`; console.log(formattedHomePhone); document.getElementById('ctl00_MainPaneContentPlaceHolder_NPMEdit1_NPMGeneral1_FormView1_rmtPhone').value = formattedHomePhone; } else if (jsonObject.ee_BASIC_info.HOMEPHONE == '' && jsonObject.ee_BASIC_info.WORKPHONE != '') { var WorkPhone = jsonObject.ee_BASIC_info.WORKPHONE; if (/[^0-9]/.test(WorkPhone)) { WorkPhone = WorkPhone.replace(/\D/g, ""); }; var PhonePart1 = WorkPhone.slice(0, 3); var PhonePart2 = WorkPhone.slice(3, 6); var PhonePart3 = WorkPhone.slice(6); var formattedWorkPhone = `(${PhonePart1}) ${PhonePart2}-${PhonePart3}`; console.log(formattedWorkPhone); document.getElementById('ctl00_MainPaneContentPlaceHolder_NPMEdit1_NPMGeneral1_FormView1_rmtPhone').value = formattedWorkPhone; }; } else if (document.getElementById('ctl00_MainPaneContentPlaceHolder_PeopleQBQBGeneral_ascx_FormView1_txtFirstName') != null) { const dic = { 'FIRST_NAME': 'ctl00_MainPaneContentPlaceHolder_PeopleQBQBGeneral_ascx_FormView1_txtFirstName', 'LAST_NAME': 'ctl00_MainPaneContentPlaceHolder_PeopleQBQBGeneral_ascx_FormView1_txtLastName', 'SSN': 'ctl00_MainPaneContentPlaceHolder_PeopleQBQBGeneral_ascx_FormView1_rmtSSN', 'ADD1': 'ctl00_MainPaneContentPlaceHolder_PeopleQBQBGeneral_ascx_FormView1_txtAddress', 'ADD2': 'ctl00_MainPaneContentPlaceHolder_PeopleQBQBGeneral_ascx_FormView1_txtAddress2', 'ADDCITY': 'ctl00_MainPaneContentPlaceHolder_PeopleQBQBGeneral_ascx_FormView1_txtCity', 'ADDZIP': 'ctl00_MainPaneContentPlaceHolder_PeopleQBQBGeneral_ascx_FormView1_txtZipcode', 'ADDSTATE': 'ctl00_MainPaneContentPlaceHolder_PeopleQBQBGeneral_ascx_FormView1_txtState', 'GENDER': 'ctl00_MainPaneContentPlaceHolder_PeopleQBQBGeneral_ascx_FormView1_rcbSex_Arrow', 'Email': 'ctl00_MainPaneContentPlaceHolder_PeopleQBQBGeneral_ascx_FormView1_txtEmail', 'MIDDLE_NAME': 'ctl00_MainPaneContentPlaceHolder_PeopleQBQBGeneral_ascx_FormView1_txtMiddleInitial', 'DOB': 'ctl00_MainPaneContentPlaceHolder_PeopleQBQBGeneral_ascx_FormView1_rdiDOB' }; for (var keyv in dic) { var itemv = dic[keyv]; var el = document.getElementById(itemv); switch (keyv) { case 'ADDSTATE': console.log(jsonObject.ee_BASIC_info[keyv]); console.log(get_short_state(jsonObject.ee_BASIC_info[keyv])); el.value = get_short_state(jsonObject.ee_BASIC_info[keyv]); break; case 'GENDER': el.click(); await delay(2); var parentDiv = document.querySelector("#ctl00_MainPaneContentPlaceHolder_PeopleQBQBGeneral_ascx_FormView1_rcbSex_DropDown > div"); var childDivs = parentDiv.querySelectorAll('li'); if (jsonObject.ee_BASIC_info[keyv] == "M" || jsonObject.ee_BASIC_info[keyv] == "Male") { var gender = 'Male'; } else if (jsonObject.ee_BASIC_info[keyv] == "F" || jsonObject.ee_BASIC_info[keyv] == "Female") { var gender = 'Female'; }; for (var i = 0; i < childDivs.length; i++) { if (childDivs[i].innerText == gender) { await delay(2); childDivs[i].click(); break; }; }; break; case 'MIDDLE_NAME': if (jsonObject.ee_BASIC_info.MIDDLE_NAME != '') { el.value = jsonObject.ee_BASIC_info.MIDDLE_NAME.charAt(0); }; break; case 'Email': if (jsonObject.ee_BASIC_info.PERSONAL_EMAIL != '') { el.value = jsonObject.ee_BASIC_info.PERSONAL_EMAIL; } else if (jsonObject.ee_BASIC_info.WORK_EMAIL != '') { el.value = jsonObject.ee_BASIC_info.WORK_EMAIL; }; break; case 'DOB': if (jsonObject.ee_BASIC_info.DOB != '') { if (jsonObject.ee_BASIC_info.DOB.includes(" ") == true) { var dob = jsonObject.ee_BASIC_info.DOB.split(" ")[0]; } else { var dob = jsonObject.ee_BASIC_info.DOB; }; }; el.value = dob; break; default: console.log(jsonObject.ee_BASIC_info[keyv]); el.value = jsonObject.ee_BASIC_info[keyv]; }; }; if (jsonObject.ee_BASIC_info.HOMEPHONE != '' && jsonObject.ee_BASIC_info.WORKPHONE != '') { var HomePhone = jsonObject.ee_BASIC_info.HOMEPHONE; if (/[^0-9]/.test(HomePhone)) { HomePhone = HomePhone.replace(/\D/g, ""); }; var PhonePart1 = HomePhone.slice(0, 3); var PhonePart2 = HomePhone.slice(3, 6); var PhonePart3 = HomePhone.slice(6); var formattedHomePhone = `(${PhonePart1}) ${PhonePart2}-${PhonePart3}`; console.log(formattedHomePhone); var WorkPhone = jsonObject.ee_BASIC_info.WORKPHONE; if (/[^0-9]/.test(WorkPhone)) { WorkPhone = WorkPhone.replace(/\D/g, ""); }; var PhonePart1 = WorkPhone.slice(0, 3); var PhonePart2 = WorkPhone.slice(3, 6); var PhonePart3 = WorkPhone.slice(6); var formattedWorkPhone = `(${PhonePart1}) ${PhonePart2}-${PhonePart3}`; console.log(formattedWorkPhone); document.getElementById('ctl00_MainPaneContentPlaceHolder_PeopleQBQBGeneral_ascx_FormView1_rmtPhone').value = formattedHomePhone; document.getElementById('ctl00_MainPaneContentPlaceHolder_PeopleQBQBGeneral_ascx_FormView1_rmtPhone2').value = formattedWorkPhone; } else if (jsonObject.ee_BASIC_info.HOMEPHONE != '' && jsonObject.ee_BASIC_info.WORKPHONE == '') { var HomePhone = jsonObject.ee_BASIC_info.HOMEPHONE; if (/[^0-9]/.test(HomePhone)) { HomePhone = HomePhone.replace(/\D/g, ""); }; var PhonePart1 = HomePhone.slice(0, 3); var PhonePart2 = HomePhone.slice(3, 6); var PhonePart3 = HomePhone.slice(6); var formattedHomePhone = `(${PhonePart1}) ${PhonePart2}-${PhonePart3}`; console.log(formattedHomePhone); document.getElementById('ctl00_MainPaneContentPlaceHolder_PeopleQBQBGeneral_ascx_FormView1_rmtPhone').value = formattedHomePhone; } else if (jsonObject.ee_BASIC_info.HOMEPHONE == '' && jsonObject.ee_BASIC_info.WORKPHONE != '') { var WorkPhone = jsonObject.ee_BASIC_info.WORKPHONE; if (/[^0-9]/.test(WorkPhone)) { WorkPhone = WorkPhone.replace(/\D/g, ""); }; var PhonePart1 = WorkPhone.slice(0, 3); var PhonePart2 = WorkPhone.slice(3, 6); var PhonePart3 = WorkPhone.slice(6); var formattedWorkPhone = `(${PhonePart1}) ${PhonePart2}-${PhonePart3}`; console.log(formattedWorkPhone); document.getElementById('ctl00_MainPaneContentPlaceHolder_PeopleQBQBGeneral_ascx_FormView1_rmtPhone').value = formattedWorkPhone; }; } else if (document.getElementById('ctl00_MainPaneContentPlaceHolder_PeopleQBQBDependentEditGeneral_ascx_FormView1_rcbRelationship') != null) { const dic_dependent = { 'FIRST_NAME': 'ctl00_MainPaneContentPlaceHolder_PeopleQBQBDependentEditGeneral_ascx_FormView1_txtFirstName', 'LAST_NAME': 'ctl00_MainPaneContentPlaceHolder_PeopleQBQBDependentEditGeneral_ascx_FormView1_txtLastName', 'MIDDLE_NAME': 'ctl00_MainPaneContentPlaceHolder_PeopleQBQBDependentEditGeneral_ascx_FormView1_txtMiddleInitial', 'Email': 'ctl00_MainPaneContentPlaceHolder_PeopleQBQBDependentEditGeneral_ascx_FormView1_txtEmail', 'SSN': 'ctl00_MainPaneContentPlaceHolder_PeopleQBQBDependentEditGeneral_ascx_FormView1_rmtSSN', 'DOB': 'ctl00_MainPaneContentPlaceHolder_PeopleQBQBDependentEditGeneral_ascx_FormView1_rdiDOB' }; if (jsonObject.ee_DEPT_info.Spouse.FIRST_NAME != "" && jsonObject.ee_DEPT_info.Spouse.is_entered == "") { async function SpouseRelation() { var elre = document.getElementById('ctl00_MainPaneContentPlaceHolder_PeopleQBQBDependentEditGeneral_ascx_FormView1_rcbRelationship_Arrow'); elre.click(); await delay(2); var parentDiv = document.querySelector("#ctl00_MainPaneContentPlaceHolder_PeopleQBQBDependentEditGeneral_ascx_FormView1_rcbRelationship_DropDown > div"); var childDivs = parentDiv.querySelectorAll('li'); if (jsonObject.ee_DEPT_info.Spouse.RELATION == 'Spouse') { var relation = 'Spouse'; } else if (jsonObject.ee_DEPT_info.Spouse.RELATION == 'Domestic Partner') { var relation = 'Domestic Partner'; }; console.log(relation); for (var i = 0; i < childDivs.length; i++) { if (childDivs[i].innerText == relation) { childDivs[i].click(); break; }; }; }; async function SpouseGender() { var el = document.getElementById('ctl00_MainPaneContentPlaceHolder_PeopleQBQBDependentEditGeneral_ascx_FormView1_rcbSex_Arrow'); el.click(); await delay(2); var parentDiv = document.querySelector("#ctl00_MainPaneContentPlaceHolder_PeopleQBQBDependentEditGeneral_ascx_FormView1_rcbSex_DropDown > div"); var childDivs = parentDiv.querySelectorAll('li'); if (jsonObject.ee_DEPT_info.Spouse.GENDER == "M" || jsonObject.ee_DEPT_info.Spouse.GENDER == "Male") { var gender = 'Male'; } else if (jsonObject.ee_DEPT_info.Spouse.GENDER == "F" || jsonObject.ee_DEPT_info.Spouse.GENDER == "Female") { var gender = 'Female'; }; for (var i = 0; i < childDivs.length; i++) { if (childDivs[i].innerText == gender) { childDivs[i].click(); break; }; }; }; async function SpouseProcess() { await delay(2); await SpouseRelation(); await delay(2); await SpouseGender(); }; SpouseProcess(); for (var keyv in dic_dependent) { var itemv = dic_dependent[keyv]; var el = document.getElementById(itemv); switch (keyv) { case 'MIDDLE_NAME': if (jsonObject.ee_DEPT_info.Spouse.MIDDLE_NAME != '') { el.value = jsonObject.ee_DEPT_info.Spouse.MIDDLE_NAME.charAt(0); }; break; case 'Email': if (jsonObject.ee_DEPT_info.Spouse.PERSONAL_EMAIL != '') { el.value = jsonObject.ee_DEPT_info.Spouse.PERSONAL_EMAIL; } else if (jsonObject.ee_DEPT_info.Spouse.WORK_EMAIL != '') { el.value = jsonObject.ee_DEPT_info.Spouse.WORK_EMAIL; }; break; case 'DOB': if (jsonObject.ee_DEPT_info.Spouse.DOB != '') { if (jsonObject.ee_DEPT_info.Spouse.DOB.includes(" ") == true) { var dob = jsonObject.ee_DEPT_info.Spouse.DOB.split(" ")[0]; } else { var dob = jsonObject.ee_DEPT_info.Spouse.DOB; }; }; el.dispatchEvent(new Event('focus')); el.dispatchEvent(new Event('click')); el.value = dob; el.dispatchEvent(new Event('change')); var ev = new Event('blur', { bubbles: true }); ev.simulated = true; el.dispatchEvent(ev); break; default: el.value = jsonObject.ee_DEPT_info.Spouse[keyv]; }; }; if (jsonObject.ee_DEPT_info.Spouse.HOMEPHONE != '' && jsonObject.ee_DEPT_info.Spouse.WORKPHONE != '') { var HomePhone = jsonObject.ee_DEPT_info.Spouse.HOMEPHONE; if (/[^0-9]/.test(HomePhone)) { HomePhone = HomePhone.replace(/\D/g, ""); }; var PhonePart1 = HomePhone.slice(0, 3); var PhonePart2 = HomePhone.slice(3, 6); var PhonePart3 = HomePhone.slice(6); var formattedHomePhone = `(${PhonePart1}) ${PhonePart2}-${PhonePart3}`; console.log(formattedHomePhone); var WorkPhone = jsonObject.ee_DEPT_info.Spouse.WORKPHONE; if (/[^0-9]/.test(WorkPhone)) { WorkPhone = WorkPhone.replace(/\D/g, ""); }; var PhonePart1 = WorkPhone.slice(0, 3); var PhonePart2 = WorkPhone.slice(3, 6); var PhonePart3 = WorkPhone.slice(6); var formattedWorkPhone = `(${PhonePart1}) ${PhonePart2}-${PhonePart3}`; console.log(formattedWorkPhone); document.getElementById('ctl00_MainPaneContentPlaceHolder_PeopleQBQBDependentEditGeneral_ascx_FormView1_rmtPhone').value = formattedHomePhone; document.getElementById('ctl00_MainPaneContentPlaceHolder_PeopleQBQBDependentEditGeneral_ascx_FormView1_rmtPhone2').value = formattedWorkPhone; } else if (jsonObject.ee_DEPT_info.Spouse.HOMEPHONE != '' && jsonObject.ee_DEPT_info.Spouse.WORKPHONE == '') { var HomePhone = jsonObject.ee_DEPT_info.Spouse.HOMEPHONE; if (/[^0-9]/.test(HomePhone)) { HomePhone = HomePhone.replace(/\D/g, ""); }; var PhonePart1 = HomePhone.slice(0, 3); var PhonePart2 = HomePhone.slice(3, 6); var PhonePart3 = HomePhone.slice(6); var formattedHomePhone = `(${PhonePart1}) ${PhonePart2}-${PhonePart3}`; console.log(formattedHomePhone); document.getElementById('ctl00_MainPaneContentPlaceHolder_PeopleQBQBDependentEditGeneral_ascx_FormView1_rmtPhone').value = formattedHomePhone; } else if (jsonObject.ee_DEPT_info.Spouse.HOMEPHONE == '' && jsonObject.ee_DEPT_info.Spouse.WORKPHONE != '') { var WorkPhone = jsonObject.ee_DEPT_info.Spouse.WORKPHONE; if (/[^0-9]/.test(WorkPhone)) { WorkPhone = WorkPhone.replace(/\D/g, ""); }; var PhonePart1 = WorkPhone.slice(0, 3); var PhonePart2 = WorkPhone.slice(3, 6); var PhonePart3 = WorkPhone.slice(6); var formattedWorkPhone = `(${PhonePart1}) ${PhonePart2}-${PhonePart3}`; console.log(formattedWorkPhone); document.getElementById('ctl00_MainPaneContentPlaceHolder_PeopleQBQBDependentEditGeneral_ascx_FormView1_rmtPhone').value = formattedWorkPhone; }; jsonObject.ee_DEPT_info.Spouse.is_entered = 'T'; } else if (jsonObject.ee_DEPT_info.Child.FIRST_NAME != '') { if (jsonObject.ee_DEPT_info.Child.FIRST_NAME.includes('|') == false) { async function ChildRelation() { var elre = document.getElementById('ctl00_MainPaneContentPlaceHolder_PeopleQBQBDependentEditGeneral_ascx_FormView1_rcbRelationship_Arrow'); elre.click(); await delay(2); var parentDiv = document.querySelector("#ctl00_MainPaneContentPlaceHolder_PeopleQBQBDependentEditGeneral_ascx_FormView1_rcbRelationship_DropDown > div"); var childDivs = parentDiv.querySelectorAll('li'); for (var i = 0; i < childDivs.length; i++) { if (childDivs[i].innerText == 'Dependent Child') { childDivs[i].click(); break; }; }; }; async function ChildGender() { var el = document.getElementById('ctl00_MainPaneContentPlaceHolder_PeopleQBQBDependentEditGeneral_ascx_FormView1_rcbSex_Arrow'); el.click(); await delay(2); var parentDiv = document.querySelector("#ctl00_MainPaneContentPlaceHolder_PeopleQBQBDependentEditGeneral_ascx_FormView1_rcbSex_DropDown > div"); var childDivs = parentDiv.querySelectorAll('li'); if (jsonObject.ee_DEPT_info.Child.GENDER == "M" || jsonObject.ee_DEPT_info.Child.GENDER == "Male") { var gender = 'Male'; } else if (jsonObject.ee_DEPT_info.Child.GENDER == "F" || jsonObject.ee_DEPT_info.Child.GENDER == "Female") { var gender = 'Female'; }; for (var i = 0; i < childDivs.length; i++) { if (childDivs[i].innerText == gender) { childDivs[i].click(); break; }; }; }; async function ChildProcess() { await delay(2); await ChildRelation(); await delay(2); await ChildGender(); }; ChildProcess(); for (var keyv in dic_dependent) { var itemv = dic_dependent[keyv]; var el = document.getElementById(itemv); switch (keyv) { case 'MIDDLE_NAME': if (jsonObject.ee_DEPT_info.Child.MIDDLE_NAME != '') { el.value = jsonObject.ee_DEPT_info.Child.MIDDLE_NAME.charAt(0); }; break; case 'Email': if (jsonObject.ee_DEPT_info.Child.PERSONAL_EMAIL != '') { el.value = jsonObject.ee_DEPT_info.Child.PERSONAL_EMAIL; } else if (jsonObject.ee_DEPT_info.Child.WORK_EMAIL != '') { el.value = jsonObject.ee_DEPT_info.Child.WORK_EMAIL; }; break; case 'DOB': if (jsonObject.ee_DEPT_info.Child.DOB != '') { if (jsonObject.ee_DEPT_info.Child.DOB.includes(" ") == true) { var dob = jsonObject.ee_DEPT_info.Child.DOB.split(" ")[0]; } else { var dob = jsonObject.ee_DEPT_info.Child.DOB; }; }; el.dispatchEvent(new Event('focus')); el.dispatchEvent(new Event('click')); el.value = dob; el.dispatchEvent(new Event('change')); var ev = new Event('blur', { bubbles: true }); ev.simulated = true; el.dispatchEvent(ev); break; default: el.value = jsonObject.ee_DEPT_info.Child[keyv]; }; }; if (jsonObject.ee_DEPT_info.Child.HOMEPHONE != '' && jsonObject.ee_DEPT_info.Child.WORKPHONE != '') { var HomePhone = jsonObject.ee_DEPT_info.Child.HOMEPHONE; if (/[^0-9]/.test(HomePhone)) { HomePhone = HomePhone.replace(/\D/g, ""); }; var PhonePart1 = HomePhone.slice(0, 3); var PhonePart2 = HomePhone.slice(3, 6); var PhonePart3 = HomePhone.slice(6); var formattedHomePhone = `(${PhonePart1}) ${PhonePart2}-${PhonePart3}`; console.log(formattedHomePhone); var WorkPhone = jsonObject.ee_DEPT_info.Child.WORKPHONE; if (/[^0-9]/.test(WorkPhone)) { WorkPhone = WorkPhone.replace(/\D/g, ""); }; var PhonePart1 = WorkPhone.slice(0, 3); var PhonePart2 = WorkPhone.slice(3, 6); var PhonePart3 = WorkPhone.slice(6); var formattedWorkPhone = `(${PhonePart1}) ${PhonePart2}-${PhonePart3}`; console.log(formattedWorkPhone); document.getElementById('ctl00_MainPaneContentPlaceHolder_PeopleQBQBDependentEditGeneral_ascx_FormView1_rmtPhone').value = formattedHomePhone; document.getElementById('ctl00_MainPaneContentPlaceHolder_PeopleQBQBDependentEditGeneral_ascx_FormView1_rmtPhone2').value = formattedWorkPhone; } else if (jsonObject.ee_DEPT_info.Child.HOMEPHONE != '' && jsonObject.ee_DEPT_info.Child.WORKPHONE == '') { var HomePhone = jsonObject.ee_DEPT_info.Child.HOMEPHONE; if (/[^0-9]/.test(HomePhone)) { HomePhone = HomePhone.replace(/\D/g, ""); }; var PhonePart1 = HomePhone.slice(0, 3); var PhonePart2 = HomePhone.slice(3, 6); var PhonePart3 = HomePhone.slice(6); var formattedHomePhone = `(${PhonePart1}) ${PhonePart2}-${PhonePart3}`; console.log(formattedHomePhone); document.getElementById('ctl00_MainPaneContentPlaceHolder_PeopleQBQBDependentEditGeneral_ascx_FormView1_rmtPhone').value = formattedHomePhone; } else if (jsonObject.ee_DEPT_info.Child.HOMEPHONE == '' && jsonObject.ee_DEPT_info.Child.WORKPHONE != '') { var WorkPhone = jsonObject.ee_DEPT_info.Child.WORKPHONE; if (/[^0-9]/.test(WorkPhone)) { WorkPhone = WorkPhone.replace(/\D/g, ""); }; var PhonePart1 = WorkPhone.slice(0, 3); var PhonePart2 = WorkPhone.slice(3, 6); var PhonePart3 = WorkPhone.slice(6); var formattedWorkPhone = `(${PhonePart1}) ${PhonePart2}-${PhonePart3}`; console.log(formattedWorkPhone); document.getElementById('ctl00_MainPaneContentPlaceHolder_PeopleQBQBDependentEditGeneral_ascx_FormView1_rmtPhone').value = formattedWorkPhone; }; jsonObject.ee_DEPT_info.Child.is_entered = 'T'; } else { async function ChildRelation() { var elre = document.getElementById('ctl00_MainPaneContentPlaceHolder_PeopleQBQBDependentEditGeneral_ascx_FormView1_rcbRelationship_Arrow'); elre.click(); await delay(2); var parentDiv = document.querySelector("#ctl00_MainPaneContentPlaceHolder_PeopleQBQBDependentEditGeneral_ascx_FormView1_rcbRelationship_DropDown > div"); var childDivs = parentDiv.querySelectorAll('li'); for (var i = 0; i < childDivs.length; i++) { if (childDivs[i].innerText == 'Dependent Child') { childDivs[i].click(); break; }; }; }; ChildRelation(); await delay(4); child_ct = jsonObject.ee_DEPT_info.Child.FIRST_NAME.split('|').length; if (jsonObject.ee_DEPT_info.Child.is_entered == '') { var child_entered_ct = 0; } else { child_entered_ct = jsonObject.ee_DEPT_info.Child.is_entered.split('|').length; }; if (child_entered_ct < child_ct) { console.log(child_entered_ct); var el = document.getElementById('ctl00_MainPaneContentPlaceHolder_PeopleQBQBDependentEditGeneral_ascx_FormView1_rcbSex_Arrow'); el.click(); var parentDiv = document.querySelector("#ctl00_MainPaneContentPlaceHolder_PeopleQBQBDependentEditGeneral_ascx_FormView1_rcbSex_DropDown > div"); var childDivs = parentDiv.querySelectorAll('li'); if (jsonObject.ee_DEPT_info.Child.GENDER.split("|")[child_entered_ct] == "M" || jsonObject.ee_DEPT_info.Child.GENDER.split("|")[child_entered_ct] == "Male") { var gender = 'Male'; } else if (jsonObject.ee_DEPT_info.Child.GENDER.split("|")[child_entered_ct] == "F" || jsonObject.ee_DEPT_info.Child.GENDER.split("|")[child_entered_ct] == "Female") { var gender = 'Female'; }; console.log(gender); for (var i = 0; i < childDivs.length; i++) { if (childDivs[i].innerText == gender) { childDivs[i].click(); break; }; }; for (var keyv in dic_dependent) { var itemv = dic_dependent[keyv]; var el = document.getElementById(itemv); switch (keyv) { case 'MIDDLE_NAME': if (jsonObject.ee_DEPT_info.Child.MIDDLE_NAME != '') { el.value = jsonObject.ee_DEPT_info.Child.MIDDLE_NAME.split("|")[child_entered_ct].charAt(0); }; break; case 'Email': if (jsonObject.ee_DEPT_info.Child.PERSONAL_EMAIL != '') { el.value = jsonObject.ee_DEPT_info.Child.PERSONAL_EMAIL.split("|")[child_entered_ct]; } else if (jsonObject.ee_DEPT_info.Child.WORK_EMAIL != '') { el.value = jsonObject.ee_DEPT_info.Child.WORK_EMAIL.split("|")[child_entered_ct]; }; break; case 'DOB': if (jsonObject.ee_DEPT_info.Child.DOB != '') { if (jsonObject.ee_DEPT_info.Child.DOB.split("|")[child_entered_ct].includes(" ") == true) { var dob = jsonObject.ee_DEPT_info.Child.DOB.split("|")[child_entered_ct].split(" ")[0]; } else { var dob = jsonObject.ee_DEPT_info.Child.DOB.split("|")[child_entered_ct]; }; }; el.dispatchEvent(new Event('focus')); el.dispatchEvent(new Event('click')); el.value = dob; el.dispatchEvent(new Event('change')); var ev = new Event('blur', { bubbles: true }); ev.simulated = true; el.dispatchEvent(ev); break; default: el.value = jsonObject.ee_DEPT_info.Child[keyv].split("|")[child_entered_ct]; }; }; }; if (child_entered_ct == 0) { jsonObject.ee_DEPT_info.Child.is_entered = "T"; } else { jsonObject.ee_DEPT_info.Child.is_entered = jsonObject.ee_DEPT_info.Child.is_entered + "|" + "T"; }; console.log(jsonObject.ee_DEPT_info.Child.is_entered); }; }; }; };
