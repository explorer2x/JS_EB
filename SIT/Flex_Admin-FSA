if (document.domain == 'flexadministratorshr.lh1ondemand.com') { function delay(n) { return new Promise(function(resolve) { setTimeout(resolve, n * 200); }); }; async function process() { const dic = { 'FIRST_NAME': 'FirstName', 'LAST_NAME': 'LastName', 'DOB': 'BirthDate', 'SSN': 'Ssn', 'PERSONAL_EMAIL': 'EmailAddress', 'ADD1': 'HomeAddress.AddressLine1', 'ADD2': 'HomeAddress.AddressLine2', 'ADDCITY': 'HomeAddress.City', 'ADDZIP': 'HomeAddress.ZipCode', 'HOMEPHONE': 'HomePhone', 'WORKPHONE': 'WorkPhone', 'DATE_OF_HIRE': 'Employment.HireDate', 'HOUR_PER_WEEK': 'Employment.HoursWorkedPerWeek', 'MIDDLE_NAME': 'MiddleInitial' }; if (jsonObject.ee_BASIC_info.DOB.includes(" ") == true) { var BirthDate = jsonObject.ee_BASIC_info.DOB.split(" ")[0]; } else { var BirthDate = jsonObject.ee_BASIC_info.DOB; } if (jsonObject.ee_BASIC_info.DATE_OF_HIRE.includes(" ") == true) { var HireDate = jsonObject.ee_BASIC_info.DATE_OF_HIRE.split(" ")[0]; } else { var HireDate = jsonObject.ee_BASIC_info.DATE_OF_HIRE; } for (var keyv in dic) { var itemv = dic[keyv]; var el = document.getElementsByName(itemv)[0]; el.focus(); switch (keyv) { case 'PERSONAL_EMAIL': if (jsonObject.ee_BASIC_info.PERSONAL_EMAIL != '') { el.value = jsonObject.ee_BASIC_info.PERSONAL_EMAIL; } else if (jsonObject.ee_BASIC_info.WORK_EMAIL != '') { el.value = jsonObject.ee_BASIC_info.WORK_EMAIL; } else { el.value = 'noemail@noemail.com'; } await delay(1); el.dispatchEvent(new Event('blur')); break; case 'MIDDLE_NAME': if (jsonObject.ee_BASIC_info.MIDDLE_NAME != '') { el.value = jsonObject.ee_BASIC_info.MIDDLE_NAME.charAt(0); }; var ev = new Event('blur', { bubbles: true }); ev.simulated = true; el.dispatchEvent(ev); break; case 'HOMEPHONE': if (jsonObject.ee_BASIC_info.HOMEPHONE != '') { var phoneNumber = jsonObject.ee_BASIC_info.HOMEPHONE; if (/[^0-9]/.test(phoneNumber)) { phoneNumber = phoneNumber.replace(/\D/g, ""); }; var PhonePart1 = phoneNumber.slice(0, 3); var PhonePart2 = phoneNumber.slice(3, 6); var PhonePart3 = phoneNumber.slice(6); var formattedPhone = `(${PhonePart1}) ${PhonePart2}-${PhonePart3}`; console.log(formattedPhone); el.value = formattedPhone; el.dispatchEvent(new Event('blur')); }; break; case 'WORKPHONE': if (jsonObject.ee_BASIC_info.WORKPHONE != '') { var phoneNumber = jsonObject.ee_BASIC_info.WORKPHONE; if (/[^0-9]/.test(phoneNumber)) { phoneNumber = phoneNumber.replace(/\D/g, ""); }; var PhonePart1 = phoneNumber.slice(0, 3); var PhonePart2 = phoneNumber.slice(3, 6); var PhonePart3 = phoneNumber.slice(6); var formattedPhone = `(${PhonePart1}) ${PhonePart2}-${PhonePart3}`; console.log(formattedPhone); el.value = formattedPhone; el.dispatchEvent(new Event('blur')); }; break; case 'SSN': var SSNNumber = jsonObject.ee_BASIC_info.SSN.replace(/-/g, ''); console.log(SSNNumber); el.value = SSNNumber; var ev = new Event('blur', { bubbles: true }) ev.simulated = true; el.dispatchEvent(ev); break; default: el.value = jsonObject.ee_BASIC_info[keyv]; var ev = new Event('blur', { bubbles: true }); ev.simulated = true; el.dispatchEvent(ev); }; }; var el = document.getElementsByName('BirthDate')[0]; el.focus(); el.value = BirthDate; el.dispatchEvent(new Event('blur')); await delay(1); var el = document.getElementsByName('Employment.HireDate')[0]; el.focus(); el.value = HireDate; el.dispatchEvent(new Event('blur')); document.querySelector("#ddl_0 > div.HeaderPanel").click(); await delay(1); console.log(jsonObject.ee_BASIC_info.GENDER); if (jsonObject.ee_BASIC_info.GENDER == 'F' || jsonObject.ee_BASIC_info.GENDER == "Female") { var Gender = 'Female'; } else if (jsonObject.ee_BASIC_info.GENDER == 'M' || jsonObject.ee_BASIC_info.GENDER == "Male") { var Gender = 'Male'; }; var parentDiv = document.querySelector("#ddl_0 > div.SelectionPanel > div.SelectionItemsContainer"); var childDivs = parentDiv.querySelectorAll('div'); for (var i = 0; i < childDivs.length; i++) { if (childDivs[i].getAttribute('title') == Gender) { childDivs[i].click(); break; }; }; MARITAL_STATUS = jsonObject.ee_BASIC_info.MARITAL_STATUS; if (MARITAL_STATUS != '') { document.querySelector("#ddl_1 > div.HeaderPanel").click(); await delay(1); var parentDiv = document.querySelector("#ddl_1 > div.SelectionPanel > div.SelectionItemsContainer"); var childDivs = parentDiv.querySelectorAll('div'); for (var i = 0; i < childDivs.length; i++) { if (childDivs[i].getAttribute('title') == MARITAL_STATUS) { childDivs[i].click(); break; }; }; }; document.querySelector("#ddlHomeStateCode > div.HeaderPanel > label").click(); await delay(1); var state = jsonObject.ee_BASIC_info.ADDSTATE; var parentDiv = document.querySelector("#ddlHomeStateCode > div.SelectionPanel> div.SelectionItemsContainer"); var childDivs = parentDiv.querySelectorAll('div'); console.log(state); for (var i = 0; i < childDivs.length; i++) { if (childDivs[i].getAttribute('title') == state) { childDivs[i].click(); break; }; }; document.querySelector("#ddlHomeCountryCode > div.HeaderPanel").click(); await delay(1); var parentDiv = document.querySelector("#ddlHomeCountryCode > div.SelectionPanel > div.SelectionItemsContainer"); var childDivs = parentDiv.querySelectorAll('div'); for (var i = 0; i < childDivs.length; i++) { if (childDivs[i].getAttribute('title') == 'United States') { childDivs[i].click(); break; }; }; }; async function start() { await process(); } start(); };
